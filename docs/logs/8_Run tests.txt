2025-04-17T21:44:37.5618876Z ##[group]Run bundle exec rspec
2025-04-17T21:44:37.5619169Z [36;1mbundle exec rspec[0m
2025-04-17T21:44:37.5667211Z shell: /usr/bin/bash -e {0}
2025-04-17T21:44:37.5667434Z env:
2025-04-17T21:44:37.5667597Z   RAILS_ENV: test
2025-04-17T21:44:37.5667997Z   DATABASE_URL: ***localhost:5432
2025-04-17T21:44:37.5668223Z ##[endgroup]
2025-04-17T21:44:40.1475730Z WebMock support loaded
2025-04-17T21:44:40.1482707Z [DEBUG] Loaded gems: actioncable, actionmailbox, actionmailer, actionpack, actiontext, actionview, activejob, activemodel, activerecord, activestorage, activesupport, addressable, ast, base64, benchmark, bigdecimal, bindex, bootsnap, brakeman, builder, bundler, capybara, concurrent-ruby, connection_pool, crack, crass, csv, date, debug, did_you_mean, diff-lcs, docile, drb, error_highlight, erubi, et-orbi, faraday, faraday-net_http, fugit, geocoder, globalid, hashdiff, hotwire-rails, i18n, importmap-rails, io-console, irb, json, language_server-protocol, lint_roller, logger, loofah, mail, marcel, matrix, mini_mime, minitest, msgpack, net-http, net-imap, net-pop, net-protocol, net-smtp, nio4r, nokogiri, parallel, parser, pathname, pg, pp, prettyprint, prism, propshaft, psych, public_suffix, puma, raabro, racc, rack, rack-session, rack-test, rackup, rails, rails-dom-testing, rails-html-sanitizer, railties, rainbow, rake, rdoc, regexp_parser, reline, rexml, rspec-core, rspec-expectations, rspec-mocks, rspec-rails, rspec-support, rubocop, rubocop-ast, rubocop-performance, rubocop-rails, rubocop-rails-omakase, ruby-progressbar, rubyzip, securerandom, selenium-webdriver, simplecov, simplecov-html, simplecov_json_formatter, solid_cache, solid_queue, stimulus-rails, stringio, syntax_suggest, tailwindcss-rails, tailwindcss-ruby, thor, thruster, timeout, turbo-rails, tzinfo, unicode-display_width, unicode-emoji, uri, useragent, vcr, web-console, webmock, websocket, websocket-driver, websocket-extensions, xpath, zeitwerk
2025-04-17T21:44:40.1490045Z Run options: exclude {cdn: true}
2025-04-17T21:44:40.1490544Z [DEBUG] GeocodingService.lookup called with query: "Portland, OR" and geocoder: Geocoder
2025-04-17T21:44:40.1491068Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.1495842Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=nil>
2025-04-17T21:44:40.1496345Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "Portland, OR"
2025-04-17T21:44:40.1497294Z [DEBUG] Geocoder.search("Portland, OR") returned: [#<Geocoder::Result::Test:0x00007fe3ebfd08a0 @data={"latitude" => 45.5152, "longitude" => -122.6784, "address" => "Portland, OR, USA", "city" => "Portland", "state" => "OR", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.1498952Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3ebfd08a0 @data={"latitude" => 45.5152, "longitude" => -122.6784, "address" => "Portland, OR, USA", "city" => "Portland", "state" => "OR", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 45.5152, "longitude" => -122.6784, "address" => "Portland, OR, USA", "city" => "Portland", "state" => "OR", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.1500647Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3ebfd08a0 @data={"latitude" => 45.5152, "longitude" => -122.6784, "address" => "Portland, OR, USA", "city" => "Portland", "state" => "OR", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.1501692Z [DEBUG] geo_result.data: {"latitude" => 45.5152, "longitude" => -122.6784, "address" => "Portland, OR, USA", "city" => "Portland", "state" => "OR", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.1502423Z [DEBUG] geo_result fields: city=Portland, state=OR, country=US, country_code=US, address=Portland, OR, USA
2025-04-17T21:44:40.1502908Z [DEBUG] FINAL location_name for "Portland, OR": "Portland, OR, US"
2025-04-17T21:44:40.1503335Z [DEBUG] Returning: lat: 45.5152, lon: -122.6784, location_name: Portland, OR, US, units: us
2025-04-17T21:44:40.1901922Z F.......[DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.1903110Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.1905556Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.1907338Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.1908450Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e9524930 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.1910790Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e9524930 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.1912700Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e9524930 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.1914038Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.1914779Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.1915297Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.1915732Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2028427Z ..[DEBUG] GeocodingService.lookup called with query: "London" and geocoder: Geocoder
2025-04-17T21:44:40.2029221Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2031992Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2033834Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "London"
2025-04-17T21:44:40.2035106Z [DEBUG] Geocoder.search("London") returned: [#<Geocoder::Result::Test:0x00007fe3e9448728 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>]
2025-04-17T21:44:40.2037137Z [DEBUG] FULL geo_results for London: [#<Geocoder::Result::Test:0x00007fe3e9448728 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>]
2025-04-17T21:44:40.2038818Z [DEBUG] geo_results[0].data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2041152Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e9448728 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>, data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2043788Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e9448728 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>
2025-04-17T21:44:40.2045282Z [DEBUG] geo_result.data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2046276Z [DEBUG] geo_result fields: city=London, state=England, country=United Kingdom, country_code=GB, address=London, England, United Kingdom
2025-04-17T21:44:40.2046869Z [DEBUG] FINAL location_name for "London": "London, England, United Kingdom"
2025-04-17T21:44:40.2047341Z [DEBUG] Returning: lat: 51.5074, lon: -0.1278, location_name: London, England, United Kingdom, units: si
2025-04-17T21:44:40.2090506Z .[DEBUG] GeocodingService.lookup called with query: "Unknown Place" and geocoder: Geocoder
2025-04-17T21:44:40.2091194Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2092484Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2093831Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "Unknown Place"
2025-04-17T21:44:40.2094550Z [DEBUG] Geocoder.search("Unknown Place") returned: []
2025-04-17T21:44:40.2144385Z .[DEBUG] GeocodingService.lookup called with query: "New York, NY; DROP TABLE users; --" and geocoder: Geocoder
2025-04-17T21:44:40.2145355Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2146975Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2148745Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY; DROP TABLE users; --"
2025-04-17T21:44:40.2149365Z [DEBUG] Geocoder.search("New York, NY; DROP TABLE users; --") returned: []
2025-04-17T21:44:40.2193875Z .[DEBUG] GeocodingService.lookup called with query: "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" and geocoder: Geocoder
2025-04-17T21:44:40.2196880Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2198472Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2202845Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
2025-04-17T21:44:40.2207726Z [DEBUG] Geocoder raised ArgumentError: unknown stub request AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2025-04-17T21:44:40.2223600Z [DEBUG] response.body for long input: "<!DOCTYPE html>\n<html>\n  <head>\n    <title>Weather</title>\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n    <meta name=\"mobile-web-app-capable\" content=\"yes\">\n    \n    \n\n    <link rel=\"icon\" type=\"image/x-icon\" href=\"/assets/favicon-37d7d545.ico\" />\n    \n\n\n    <link rel=\"icon\" href=\"/icon.png\" type=\"image/png\">\n    <link rel=\"icon\" href=\"/icon.svg\" type=\"image/svg+xml\">\n    <link rel=\"apple-touch-icon\" href=\"/icon.png\">\n\n    <link rel=\"stylesheet\" href=\"/assets/application-8b441ae0.css\" data-turbo-track=\"reload\" />\n    <script type=\"importmap\" data-turbo-track=\"reload\">{\n  \"imports\": {\n    \"application\": \"/assets/application-bfcdf840.js\",\n    \"@hotwired/turbo-rails\": \"/assets/turbo.min-1262d735.js\",\n    \"@hotwired/stimulus\": \"/assets/stimulus.min-4b1e420e.js\",\n    \"@hotwired/stimulus-loading\": \"/assets/stimulus-loading-1fc53fe7.js\",\n    \"controllers/application\": \"/assets/controllers/application-3affb389.js\",\n    \"controllers/clear_form_controller\": \"/assets/controllers/clear_form_controller-0b549570.js\",\n    \"controllers\": \"/assets/controllers/index-ee64e1f1.js\"\n  }\n}</script>\n<link rel=\"modulepreload\" href=\"/assets/application-bfcdf840.js\">\n<link rel=\"modulepreload\" href=\"/assets/turbo.min-1262d735.js\">\n<link rel=\"modulepreload\" href=\"/assets/stimulus.min-4b1e420e.js\">\n<link rel=\"modulepreload\" href=\"/assets/stimulus-loading-1fc53fe7.js\">\n<link rel=\"modulepreload\" href=\"/assets/controllers/application-3affb389.js\">\n<link rel=\"modulepreload\" href=\"/assets/controllers/clear_form_controller-0b549570.js\">\n<link rel=\"modulepreload\" href=\"/assets/controllers/index-ee64e1f1.js\">\n<script type=\"module\">import \"application\"</script>\n  </head>\n\n  <body>\n    <main class=\"container mx-auto mt-28 px-5 flex\">\n      <div class=\"fixed inset-0 min-h-screen w-screen bg-gradient-to-br from-blue-200 via-blue-400 to-blue-700 flex items-center justify-center\">\n  <div class=\"w-full max-w-md md:max-w-xl lg:max-w-3xl bg-white/80 rounded-xl shadow-lg p-8\">\n    <h1 class=\"text-3xl font-bold text-center mb-4 text-blue-900 tracking-tight\">Weather Forecast</h1>\n      <div class=\"mb-4 p-3 rounded bg-red-100 text-red-700 text-center\">\n    Could not geocode query.\n  </div>\n\n    <form data-controller=\"clear-form\" data-action=\"turbo:submit-end-&gt;clear-form#reset\" action=\"/forecasts\" accept-charset=\"UTF-8\" method=\"post\">\n      <div class=\"mb-4\">\n        <label class=\"block text-blue-900 font-semibold mb-2\" for=\"query\">Enter a location</label>\n        <input class=\"w-full px-4 py-2 rounded border border-blue-200 bg-white focus:ring-2 focus:ring-blue-400 focus:outline-none text-lg\" autofocus=\"autofocus\" placeholder=\"address, city, or postal code\" type=\"text\" name=\"query\" id=\"query\" />\n      </div>\n      <div>\n        <input type=\"submit\" name=\"commit\" value=\"Get Forecast\" class=\"w-full py-2 px-4 rounded bg-blue-600 hover:bg-blue-700 text-white font-bold text-lg transition\" data-disable-with=\"Get Forecast\" />\n      </div>\n</form>    <turbo-frame id=\"forecast-result\">\n    </turbo-frame>\n    <div class=\"mt-6 text-center text-blue-700 text-xs opacity-60\">\n      <span>Powered by Pirate Weather & Geocoder</span>\n    </div>\n  </div>\n</div>\n\n    </main>\n  </body>\n</html>\n"
2025-04-17T21:44:40.2266875Z .[DEBUG] GeocodingService.lookup called with query: "<script>alert('x')</script>" and geocoder: Geocoder
2025-04-17T21:44:40.2267799Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2269390Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2271263Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "<script>alert('x')</script>"
2025-04-17T21:44:40.2271988Z [DEBUG] Geocoder.search("<script>alert('x')</script>") returned: []
2025-04-17T21:44:40.2491203Z .......[DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.2492202Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2494603Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2496812Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.2498598Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e8faffb8 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2502692Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8faffb8 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2506179Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8faffb8 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2507856Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2509113Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.2510140Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.2510906Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2519023Z F[DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.2519935Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2522248Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2524769Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.2526328Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e8fa2020 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2529404Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8fa2020 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2532275Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8fa2020 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2534367Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2535677Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.2536682Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.2537560Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2538456Z [DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.2539155Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2541682Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2544263Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.2545820Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e8e6f478 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2548653Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8e6f478 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2551548Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8e6f478 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2553413Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2554692Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.2555548Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.2556284Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2557229Z F[DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.2557948Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2560482Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2563409Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.2564994Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e8e8fde0 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2567253Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8e8fde0 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2568758Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8e8fde0 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2570200Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2571184Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.2571749Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.2572167Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2590684Z F.[DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.2591187Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2592775Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2594138Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.2595419Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e8eb5fb8 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2597224Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8eb5fb8 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2598710Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8eb5fb8 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2599954Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2600660Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.2601321Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.2601729Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2611511Z .[DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.2612198Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2613998Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2616050Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.2616939Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e8dab5a0 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2618441Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8dab5a0 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2620104Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8dab5a0 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2621242Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2622329Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.2622806Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.2623453Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2631639Z F[DEBUG] GeocodingService.lookup called with query: "London" and geocoder: Geocoder
2025-04-17T21:44:40.2632309Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2634374Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2635759Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "London"
2025-04-17T21:44:40.2637109Z [DEBUG] Geocoder.search("London") returned: [#<Geocoder::Result::Test:0x00007fe3e8da2540 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>]
2025-04-17T21:44:40.2638606Z [DEBUG] FULL geo_results for London: [#<Geocoder::Result::Test:0x00007fe3e8da2540 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>]
2025-04-17T21:44:40.2640057Z [DEBUG] geo_results[0].data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2641945Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8da2540 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>, data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2644718Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8da2540 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>
2025-04-17T21:44:40.2646138Z [DEBUG] geo_result.data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2647310Z [DEBUG] geo_result fields: city=London, state=England, country=United Kingdom, country_code=GB, address=London, England, United Kingdom
2025-04-17T21:44:40.2647899Z [DEBUG] FINAL location_name for "London": "London, England, United Kingdom"
2025-04-17T21:44:40.2648377Z [DEBUG] Returning: lat: 51.5074, lon: -0.1278, location_name: London, England, United Kingdom, units: si
2025-04-17T21:44:40.2652217Z .[DEBUG] GeocodingService.lookup called with query: "Ambiguous" and geocoder: Geocoder
2025-04-17T21:44:40.2652906Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2655132Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2657002Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "Ambiguous"
2025-04-17T21:44:40.2658989Z [DEBUG] Geocoder.search("Ambiguous") returned: [#<Geocoder::Result::Test:0x00007fe3e8dd3370 @data={"latitude" => 37.7749, "longitude" => -122.4194, "address" => "San Francisco, CA, USA", "city" => "San Francisco", "state" => "CA", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, #<Geocoder::Result::Test:0x00007fe3e8dd2cb8 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>]
2025-04-17T21:44:40.2661760Z [DEBUG] FULL geo_results for Ambiguous: [#<Geocoder::Result::Test:0x00007fe3e8dd3370 @data={"latitude" => 37.7749, "longitude" => -122.4194, "address" => "San Francisco, CA, USA", "city" => "San Francisco", "state" => "CA", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, #<Geocoder::Result::Test:0x00007fe3e8dd2cb8 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>]
2025-04-17T21:44:40.2663445Z [DEBUG] geo_results[0].data: {"latitude" => 37.7749, "longitude" => -122.4194, "address" => "San Francisco, CA, USA", "city" => "San Francisco", "state" => "CA", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2664411Z [DEBUG] geo_results[1].data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2665885Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8dd3370 @data={"latitude" => 37.7749, "longitude" => -122.4194, "address" => "San Francisco, CA, USA", "city" => "San Francisco", "state" => "CA", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 37.7749, "longitude" => -122.4194, "address" => "San Francisco, CA, USA", "city" => "San Francisco", "state" => "CA", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2668631Z [DEBUG] geo_results[1]: #<Geocoder::Result::Test:0x00007fe3e8dd2cb8 @data={"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}, @cache_hit=nil>, data: {"latitude" => 51.5074, "longitude" => -0.1278, "address" => "London, England, United Kingdom", "city" => "London", "state" => "England", "country" => "United Kingdom", "country_code" => "GB"}
2025-04-17T21:44:40.2671289Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8dd3370 @data={"latitude" => 37.7749, "longitude" => -122.4194, "address" => "San Francisco, CA, USA", "city" => "San Francisco", "state" => "CA", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2672713Z [DEBUG] geo_result.data: {"latitude" => 37.7749, "longitude" => -122.4194, "address" => "San Francisco, CA, USA", "city" => "San Francisco", "state" => "CA", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2673479Z [DEBUG] geo_result fields: city=San Francisco, state=CA, country=US, country_code=US, address=San Francisco, CA, USA
2025-04-17T21:44:40.2673985Z [DEBUG] FINAL location_name for "Ambiguous": "San Francisco, CA, US"
2025-04-17T21:44:40.2674422Z [DEBUG] Returning: lat: 37.7749, lon: -122.4194, location_name: San Francisco, CA, US, units: us
2025-04-17T21:44:40.2677472Z .[DEBUG] GeocodingService.lookup called with query: "Nowhere" and geocoder: Geocoder
2025-04-17T21:44:40.2678115Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2680128Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2681469Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "Nowhere"
2025-04-17T21:44:40.2682263Z [DEBUG] Geocoder.search("Nowhere") returned: [#<Geocoder::Result::Test:0x00007fe3e8df3058 @data={"latitude" => 10.0, "longitude" => 10.0, "address" => "Nowhere", "city" => nil, "state" => nil, "country" => nil, "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2683669Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8df3058 @data={"latitude" => 10.0, "longitude" => 10.0, "address" => "Nowhere", "city" => nil, "state" => nil, "country" => nil, "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 10.0, "longitude" => 10.0, "address" => "Nowhere", "city" => nil, "state" => nil, "country" => nil, "country_code" => "US"}
2025-04-17T21:44:40.2685013Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8df3058 @data={"latitude" => 10.0, "longitude" => 10.0, "address" => "Nowhere", "city" => nil, "state" => nil, "country" => nil, "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2685925Z [DEBUG] geo_result.data: {"latitude" => 10.0, "longitude" => 10.0, "address" => "Nowhere", "city" => nil, "state" => nil, "country" => nil, "country_code" => "US"}
2025-04-17T21:44:40.2686508Z [DEBUG] geo_result fields: city=, state=, country=, country_code=US, address=Nowhere
2025-04-17T21:44:40.2686879Z [DEBUG] FINAL location_name for "Nowhere": "Nowhere"
2025-04-17T21:44:40.2687222Z [DEBUG] Returning: lat: 10.0, lon: 10.0, location_name: Nowhere, units: us
2025-04-17T21:44:40.2710239Z .[DEBUG] GeocodingService.lookup called with query: "Unknown Place" and geocoder: Geocoder
2025-04-17T21:44:40.2710928Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2712867Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2714290Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "Unknown Place"
2025-04-17T21:44:40.2714655Z [DEBUG] Geocoder.search("Unknown Place") returned: []
2025-04-17T21:44:40.2725918Z .[DEBUG] GeocodingService.lookup called with query: "New York, NY" and geocoder: Geocoder
2025-04-17T21:44:40.2726788Z [DEBUG] Geocoder Lookup: :test
2025-04-17T21:44:40.2728619Z [DEBUG] Geocoder Lookup Class: #<Geocoder::Lookup::Test:0x00007fe3ebfd6840 @cache=#<Geocoder::Cache:0x00007fe3ec0078c8 @class=Geocoder::CacheStore::Generic, @store_service=#<Geocoder::CacheStore::Generic:0x00007fe3ec005078 @store=#<ActiveSupport::Cache::MemoryStore entries=0, size=0, options={compress: false, compress_threshold: 1024}>, @config={prefix: "geocoder:", expiration: nil}, @prefix="geocoder:">>>
2025-04-17T21:44:40.2730142Z [DEBUG] [STUB CHECK] Geocoder.search called with query: "New York, NY"
2025-04-17T21:44:40.2731483Z [DEBUG] Geocoder.search("New York, NY") returned: [#<Geocoder::Result::Test:0x00007fe3e8d53800 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>]
2025-04-17T21:44:40.2733039Z [DEBUG] geo_results[0]: #<Geocoder::Result::Test:0x00007fe3e8d53800 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>, data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2734503Z [DEBUG] Picked geo_result: #<Geocoder::Result::Test:0x00007fe3e8d53800 @data={"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}, @cache_hit=nil>
2025-04-17T21:44:40.2735469Z [DEBUG] geo_result.data: {"latitude" => 40.7128, "longitude" => -74.006, "address" => "New York, NY, USA", "city" => "New York", "state" => "NY", "country" => "US", "country_code" => "US"}
2025-04-17T21:44:40.2736152Z [DEBUG] geo_result fields: city=New York, state=NY, country=US, country_code=US, address=New York, NY, USA
2025-04-17T21:44:40.2736625Z [DEBUG] FINAL location_name for "New York, NY": "New York, NY, US"
2025-04-17T21:44:40.2737025Z [DEBUG] Returning: lat: 40.7128, lon: -74.006, location_name: New York, NY, US, units: us
2025-04-17T21:44:40.2937408Z F......
2025-04-17T21:44:40.3396868Z 
2025-04-17T21:44:40.3397253Z Failures:
2025-04-17T21:44:40.3397463Z 
2025-04-17T21:44:40.3397681Z   1) Weather Forecast shows a forecast for a location
2025-04-17T21:44:40.3398280Z      Failure/Error: expect(page).to have_content('Portland')
2025-04-17T21:44:40.3399326Z        expected to find text "Portland" in "Weather Forecast\nError fetching weather data.\nEnter a location\nPowered by Pirate Weather & Geocoder"
2025-04-17T21:44:40.3400731Z      # ./spec/features/forecast_spec.rb:9:in 'block (2 levels) in <top (required)>'
2025-04-17T21:44:40.3401509Z      # ./spec/rails_helper.rb:88:in 'block (2 levels) in <top (required)>'
2025-04-17T21:44:40.3401955Z 
2025-04-17T21:44:40.3402202Z   2) ForecastService.fetch caches the forecast for an query
2025-04-17T21:44:40.3402850Z      Failure/Error: expect(forecast).to include(fake_forecast)
2025-04-17T21:44:40.3404224Z        expected nil to include {"currently" => {"temperature" => 75}, "daily" => {"summary" => "Sunny", "icon" => "clear-day", "data" => [{"icon" => "clear-day", "temperatureHigh" => 80, "temperatureLow" => 60}]}}, but it does not respond to `include?`
2025-04-17T21:44:40.3406158Z      # ./spec/services/forecast_service_spec.rb:34:in 'block (3 levels) in <top (required)>'
2025-04-17T21:44:40.3406983Z      # ./spec/rails_helper.rb:88:in 'block (2 levels) in <top (required)>'
2025-04-17T21:44:40.3407421Z 
2025-04-17T21:44:40.3407733Z   3) ForecastService.fetch returns cached forecast on subsequent calls
2025-04-17T21:44:40.3408431Z      Failure/Error: expect(forecast).to include(fake_forecast)
2025-04-17T21:44:40.3410042Z        expected nil to include {"currently" => {"temperature" => 75}, "daily" => {"summary" => "Sunny", "icon" => "clear-day", "data" => [{"icon" => "clear-day", "temperatureHigh" => 80, "temperatureLow" => 60}]}}, but it does not respond to `include?`
2025-04-17T21:44:40.3411843Z      # ./spec/services/forecast_service_spec.rb:45:in 'block (3 levels) in <top (required)>'
2025-04-17T21:44:40.3412616Z      # ./spec/rails_helper.rb:88:in 'block (2 levels) in <top (required)>'
2025-04-17T21:44:40.3413024Z 
2025-04-17T21:44:40.3413312Z   4) ForecastService.fetch fetches new forecast when refresh is true
2025-04-17T21:44:40.3413942Z      Failure/Error: expect(forecast).to eq(new_forecast)
2025-04-17T21:44:40.3414284Z 
2025-04-17T21:44:40.3415030Z        expected: {"currently" => {"temperature" => 80}, "daily" => {"data" => [{"icon" => "clear-day", "temperatureHigh" => 80, "temperatureLow" => 60}], "icon" => "clear-day", "summary" => "Sunny"}}
2025-04-17T21:44:40.3415998Z             got: nil
2025-04-17T21:44:40.3416199Z 
2025-04-17T21:44:40.3416330Z        (compared using ==)
2025-04-17T21:44:40.3416872Z      # ./spec/services/forecast_service_spec.rb:54:in 'block (3 levels) in <top (required)>'
2025-04-17T21:44:40.3417636Z      # ./spec/rails_helper.rb:88:in 'block (2 levels) in <top (required)>'
2025-04-17T21:44:40.3418023Z 
2025-04-17T21:44:40.3418286Z   5) ForecastService.fetch handles missing/malformed forecast data
2025-04-17T21:44:40.3418864Z      Failure/Error: expect(forecast).to eq({})
2025-04-17T21:44:40.3419163Z 
2025-04-17T21:44:40.3419268Z        expected: {}
2025-04-17T21:44:40.3419595Z             got: nil
2025-04-17T21:44:40.3419968Z 
2025-04-17T21:44:40.3420089Z        (compared using ==)
2025-04-17T21:44:40.3420645Z      # ./spec/services/forecast_service_spec.rb:76:in 'block (3 levels) in <top (required)>'
2025-04-17T21:44:40.3421403Z      # ./spec/rails_helper.rb:88:in 'block (2 levels) in <top (required)>'
2025-04-17T21:44:40.3421805Z 
2025-04-17T21:44:40.3422103Z   6) ForecastService.fetch handles malformed forecast hash (missing keys)
2025-04-17T21:44:40.3422689Z      Failure/Error: expect(forecast).to eq({})
2025-04-17T21:44:40.3422995Z 
2025-04-17T21:44:40.3423100Z        expected: {}
2025-04-17T21:44:40.3423395Z             got: nil
2025-04-17T21:44:40.3423617Z 
2025-04-17T21:44:40.3423730Z        (compared using ==)
2025-04-17T21:44:40.3424299Z      # ./spec/services/forecast_service_spec.rb:151:in 'block (3 levels) in <top (required)>'
2025-04-17T21:44:40.3425053Z      # ./spec/rails_helper.rb:88:in 'block (2 levels) in <top (required)>'
2025-04-17T21:44:40.3425473Z 
2025-04-17T21:44:40.3425695Z Finished in 0.19729 seconds (files took 2.29 seconds to load)
2025-04-17T21:44:40.3426166Z 38 examples, 6 failures
2025-04-17T21:44:40.3426359Z 
2025-04-17T21:44:40.3426468Z Failed examples:
2025-04-17T21:44:40.3426641Z 
2025-04-17T21:44:40.3427017Z rspec ./spec/features/forecast_spec.rb:4 # Weather Forecast shows a forecast for a location
2025-04-17T21:44:40.3428005Z rspec ./spec/services/forecast_service_spec.rb:29 # ForecastService.fetch caches the forecast for an query
2025-04-17T21:44:40.3429213Z rspec ./spec/services/forecast_service_spec.rb:40 # ForecastService.fetch returns cached forecast on subsequent calls
2025-04-17T21:44:40.3430585Z rspec ./spec/services/forecast_service_spec.rb:49 # ForecastService.fetch fetches new forecast when refresh is true
2025-04-17T21:44:40.3431767Z rspec ./spec/services/forecast_service_spec.rb:72 # ForecastService.fetch handles missing/malformed forecast data
2025-04-17T21:44:40.3433281Z rspec ./spec/services/forecast_service_spec.rb:147 # ForecastService.fetch handles malformed forecast hash (missing keys)
2025-04-17T21:44:40.3434001Z 
2025-04-17T21:44:40.4638368Z Stopped processing SimpleCov as a previous error not related to SimpleCov has been detected
2025-04-17T21:44:40.4639539Z Coverage report generated for RSpec to /home/runner/work/weather-rails-app/weather-rails-app/coverage.
2025-04-17T21:44:40.4641543Z Line Coverage: 88.89% (96 / 108)
2025-04-17T21:44:40.4882595Z ##[error]Process completed with exit code 1.
